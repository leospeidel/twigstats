<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Function to calculate Fst from Relate trees for pairs of populations specified in poplabels. — Fst_blocks_from_Relate • twigstats</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Function to calculate Fst from Relate trees for pairs of populations specified in poplabels. — Fst_blocks_from_Relate"><meta property="og:description" content="This function will calculate Fst in blocks of prespecified size for all pairs of populations specified in the poplabels file.
Please refer to the Relate documentation for input file formats (https://myersgroup.github.io/relate/).
The output is in the same format as for f2_blocks_from_Relate."><meta property="og:image" content="https://leospeidel.github.io/twigstats/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-P8RP1CGQ1W"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-P8RP1CGQ1W');
</script></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">twigstats</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/basic-usage.html">Basic usage</a>
    </li>
    <li>
      <a href="../articles/real-data-example.html">A small real data example</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/leospeidel/twigstats/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Function to calculate Fst from Relate trees for pairs of populations specified in poplabels.</h1>
    <small class="dont-index">Source: <a href="https://github.com/leospeidel/twigstats/blob/HEAD/R/RcppExports.R" class="external-link"><code>R/RcppExports.R</code></a></small>
    <div class="hidden name"><code>Fst_blocks_from_Relate.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function will calculate Fst in blocks of prespecified size for all pairs of populations specified in the poplabels file.
Please refer to the Relate documentation for input file formats (https://myersgroup.github.io/relate/).
The output is in the same format as for f2_blocks_from_Relate.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">Fst_blocks_from_Relate</span><span class="op">(</span></span>
<span>  <span class="va">file_anc</span>,</span>
<span>  <span class="va">file_mut</span>,</span>
<span>  <span class="va">poplabels</span>,</span>
<span>  file_map <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  chrs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  blgsize <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  mu <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  tmin <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  t <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  transitions <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  use_muts <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  minMAF <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  Fst <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  dump_blockpos <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  apply_corr <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-file-anc">file_anc<a class="anchor" aria-label="anchor" href="#arg-file-anc"></a></dt>
<dd><p>Filename of anc file. If chrs is specified, this should only be the prefix, resulting in filenames of ${file_anc}_chr${chr}.anc(.gz).</p></dd>


<dt id="arg-file-mut">file_mut<a class="anchor" aria-label="anchor" href="#arg-file-mut"></a></dt>
<dd><p>Filename of mut file. If chrs is specified, this should only be the prefix, resulting in filenames of ${file_anc}_chr${chr}.anc(.gz).</p></dd>


<dt id="arg-poplabels">poplabels<a class="anchor" aria-label="anchor" href="#arg-poplabels"></a></dt>
<dd><p>Filename of poplabels file</p></dd>


<dt id="arg-file-map">file_map<a class="anchor" aria-label="anchor" href="#arg-file-map"></a></dt>
<dd><p>(Optional) File prefix of recombination map. Not needed if blgsize is given in base-pairs, i.e. blgsize &gt; 100</p></dd>


<dt id="arg-chrs">chrs<a class="anchor" aria-label="anchor" href="#arg-chrs"></a></dt>
<dd><p>(Optional) Vector of chromosome IDs</p></dd>


<dt id="arg-blgsize">blgsize<a class="anchor" aria-label="anchor" href="#arg-blgsize"></a></dt>
<dd><p>(Optional) SNP block size. Default is 10000 bases. If blgsize is &lt;100 then it will be interpreted in Morgan. If blgsize is 100 or greater, if will be interpreted as base pair distance. If blgsize is negative, every tree is its own block.</p></dd>


<dt id="arg-mu">mu<a class="anchor" aria-label="anchor" href="#arg-mu"></a></dt>
<dd><p>(Optional) Per base per generation mutation rate to scale f2 values. Default: 1.25e-8</p></dd>


<dt id="arg-tmin">tmin<a class="anchor" aria-label="anchor" href="#arg-tmin"></a></dt>
<dd><p>(Optional) Minimum time cutof in generations. Any lineages younger than tmin will be excluded from the analysis. Default: t = 0.</p></dd>


<dt id="arg-t">t<a class="anchor" aria-label="anchor" href="#arg-t"></a></dt>
<dd><p>(Optional) Time cutoff in generations. Default: Inf</p></dd>


<dt id="arg-transitions">transitions<a class="anchor" aria-label="anchor" href="#arg-transitions"></a></dt>
<dd><p>(Optional) Set this to FALSE to exclude transition SNPs. Only meaningful with use_muts</p></dd>


<dt id="arg-use-muts">use_muts<a class="anchor" aria-label="anchor" href="#arg-use-muts"></a></dt>
<dd><p>(Optional) Calculate traditional f2 statistics by only using mutations mapped to Relate trees. Default: false.</p></dd>


<dt id="arg-minmaf">minMAF<a class="anchor" aria-label="anchor" href="#arg-minmaf"></a></dt>
<dd><p>(Optional) Minimum frequency cutoff. Default: 1 (i.e. excl singletons)</p></dd>


<dt id="arg-dump-blockpos">dump_blockpos<a class="anchor" aria-label="anchor" href="#arg-dump-blockpos"></a></dt>
<dd><p>(Optional) Filename of blockpos file.</p></dd>


<dt id="arg-apply-corr">apply_corr<a class="anchor" aria-label="anchor" href="#arg-apply-corr"></a></dt>
<dd><p>(Optional) Use small sample size correction. Default: true.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>3d array of dimension #groups x #groups x #blocks. Analogous to output of f2_from_geno in admixtools.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">file_anc</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"sim/msprime_ad0.8_split250_1_chr1.anc.gz"</span>, package <span class="op">=</span> <span class="st">"twigstats"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">file_mut</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"sim/msprime_ad0.8_split250_1_chr1.mut.gz"</span>, package <span class="op">=</span> <span class="st">"twigstats"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">poplabels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"sim/msprime_ad0.8_split250_1.poplabels"</span>, package <span class="op">=</span> <span class="st">"twigstats"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">file_map</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"sim/genetic_map_combined_b37_chr1.txt.gz"</span>, package <span class="op">=</span> <span class="st">"twigstats"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Calculate f2s between all pairs of populations</span></span></span>
<span class="r-in"><span><span class="va">Fst_blocks</span> <span class="op">&lt;-</span> <span class="fu">Fst_blocks_from_Relate</span><span class="op">(</span><span class="va">file_anc</span>, <span class="va">file_mut</span>, <span class="va">poplabels</span>, <span class="va">file_map</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Use a cutoff of 500 generations</span></span></span>
<span class="r-in"><span><span class="va">Fst_blocks</span> <span class="op">&lt;-</span> <span class="fu">Fst_blocks_from_Relate</span><span class="op">(</span><span class="va">file_anc</span>, <span class="va">file_mut</span>, <span class="va">poplabels</span>, <span class="va">file_map</span>, dump_blockpos <span class="op">=</span> <span class="st">"test.pos"</span>, t <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Leo Speidel, Pontus Skoglund.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

